

---=============Amazon SQL Interview Questions===============================


/*1. Given a table SELLERS with 3 column SELLER_ID, COUNTRY and JOINING_DATE, write a query to 
identify number of sellers per country and order it in descending order of no. of sellers*/

Create table SELLERS(SELLER_ID int identity(1,1),COUNTRY varchar(100),JOINING_DATE datetime)

Declare @a int, @b int

Set @a = 1
Set @b = 1000

While @a<= @b
  Begin
        Insert into SELLERS(JOINING_DATE)
		Select GETDATE()+@a
		Set @a = @a+1
  End

Select * from SELLERS

  Update SELLERS
  Set COUNTRY = 'India'
  Where SELLER_ID between 1 and 300

   Update SELLERS
  Set COUNTRY = 'USA'
  Where SELLER_ID between 301 and 600

    Update SELLERS
  Set COUNTRY = 'UK'
  Where SELLER_ID between 601 and 900

  Update SELLERS
  Set COUNTRY = 'SA'
  Where SELLER_ID between 901 and 1000

  Select * from SELLERS

--1. 

Select COUNTRY,count(SELLER_ID) as number_Of_sellers from SELLERS
Group by COUNTRY
order by 2 desc 

--2. For the table in question 1 write a query to extract all sellers who joined on a Monday.

Select Datename(dw,JOINING_DATE), * from SELLERS where Datename(dw,JOINING_DATE) = 'Monday'

--3. Given a table EMPLOYEE with two columns EMP_ID and SALARY, how can we extract alternate rows from a table?
Select * from EmployeeTest

Select  row_number() over (order by empid desc) as Ranking ,* into #test from EmployeeTest

Select * from #test where Ranking%2<>0

-- find distinct values without using distinct keyword

Select * from EmpSalary order by 1 

Select * from (Select *, row_number() over (Partition by EmpID,EmpName,Empsalary,DeptID order by empid desc) as Ranking 
                from EmpSalary) k where k.Ranking>1

--4. Given a table EMPLOYEE with two columns EMP_ID and SALARY, extract the employees with the 3rd highest salary.

Select  dense_rank() over (order by Salary desc) as Ranking ,* into #test4 from EmployeeTest

Select * from #test4 where Ranking=3



 --5. Consider a table EMPLOYEE with columns EMP_ID, DEPT_NO and SALARY. Write a query to extract all employees who have 
 --salaries higher than the avg. of their department.

 select * 
 from Employee e
 Join (Select Department,Avg(salary) as AVGSalary from Employee
 Group by Department) s on s.Department = e.Department
 where e.salary>s.AVGSalary 

